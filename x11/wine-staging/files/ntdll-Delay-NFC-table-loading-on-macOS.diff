From 35c223850e1bc9e8f97bfaf403bfabca69db3447 Mon Sep 17 00:00:00 2001
From: Alexandre Julliard <julliard@winehq.org>
Date: Tue, 3 Mar 2020 09:06:21 +0100
Subject: [PATCH] ntdll: Delay NFC table loading on macOS.

Wine-Bug: https://bugs.winehq.org/show_bug.cgi?id=48689
Signed-off-by: Alexandre Julliard <julliard@winehq.org>
---
 dlls/ntdll/locale.c | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

diff --git dlls/ntdll/locale.c dlls/ntdll/locale.c
index 8a2b233f881..5602c18df53 100644
--- dlls/ntdll/locale.c
+++ dlls/ntdll/locale.c
@@ -799,13 +799,7 @@ void init_unix_codepage(void)
 
 #else  /* __APPLE__ || __ANDROID__ */
 
-void init_unix_codepage(void)
-{
-#ifdef __APPLE__
-    const struct norm_table *info;
-    load_norm_table( NormalizationC, &info );
-#endif
-}
+void init_unix_codepage(void) { }
 
 #endif  /* __APPLE__ || __ANDROID__ */
 
@@ -909,6 +903,10 @@ void init_locale( HMODULE module )
     user_lcid = unix_locale_to_lcid( setlocale( LC_MESSAGES, NULL ));
 
 #ifdef __APPLE__
+    {
+        const struct norm_table *info;
+        load_norm_table( NormalizationC, &info );
+    }
     if (!system_lcid)
     {
         char buffer[LOCALE_NAME_MAX_LENGTH];
